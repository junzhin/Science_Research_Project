Namespace(arch='resnet18', batch_size=128, bottleneck_dim=256, center_crop=False, checkmodel_logsave=False, data='Office31', data_processing='ours', epochs=50, iters_per_epoch=500, local=True, local_pretrained_path='/home/junzhin/Project/Summer_project/code/version1.0/old_model_results/Resnet18_office31masked2Random_newmodel_best.pth.tar', log='/home/junzhin/Project/Summer_project/code/version2.0/log', lr=0.01, lr_decay=0.75, lr_gamma=0.001, momentum=0.9, per_class_eval=False, phase='train', pretrained=True, print_freq=50, root='/home/junzhin/Project/Summer_project/code/version2.0/data/office31', seed=None, source='A', target='D', trade_off=1.0, weight_decay=0.001, workers=4)
=> using pre-trained model 'resnet18'
Epoch: [0][  0/500]	Time  2.97 ( 2.97)	Data  0.54 ( 0.54)	Loss   4.28 (  4.28)	Cls Acc 1.6 (1.6)	Domain Acc 54.7 (54.7)
Epoch: [0][ 50/500]	Time  0.49 ( 1.54)	Data  0.36 ( 1.36)	Loss   2.66 (  3.27)	Cls Acc 28.1 (15.4)	Domain Acc 98.0 (94.1)
Epoch: [0][100/500]	Time  0.50 ( 1.56)	Data  0.37 ( 1.40)	Loss   2.47 (  2.92)	Cls Acc 24.2 (23.4)	Domain Acc 98.8 (95.9)
Epoch: [0][150/500]	Time  3.48 ( 1.56)	Data  3.34 ( 1.41)	Loss   1.97 (  2.69)	Cls Acc 45.3 (28.8)	Domain Acc 98.0 (96.6)
Epoch: [0][200/500]	Time  0.49 ( 1.56)	Data  0.35 ( 1.41)	Loss   1.75 (  2.50)	Cls Acc 57.0 (33.7)	Domain Acc 97.3 (97.1)
Epoch: [0][250/500]	Time  0.50 ( 1.56)	Data  0.37 ( 1.42)	Loss   1.58 (  2.34)	Cls Acc 56.2 (37.4)	Domain Acc 99.2 (97.4)
Epoch: [0][300/500]	Time  3.52 ( 1.57)	Data  3.39 ( 1.42)	Loss   1.27 (  2.21)	Cls Acc 66.4 (40.8)	Domain Acc 99.2 (97.6)
Epoch: [0][350/500]	Time  0.50 ( 1.56)	Data  0.36 ( 1.41)	Loss   1.42 (  2.10)	Cls Acc 61.7 (43.7)	Domain Acc 98.8 (97.7)
Epoch: [0][400/500]	Time  0.50 ( 1.56)	Data  0.36 ( 1.42)	Loss   1.09 (  2.01)	Cls Acc 72.7 (46.3)	Domain Acc 97.7 (97.7)
Epoch: [0][450/500]	Time  3.66 ( 1.56)	Data  3.52 ( 1.42)	Loss   1.05 (  1.92)	Cls Acc 71.1 (48.7)	Domain Acc 98.0 (97.7)
Test: [0/4]	Time  3.943 ( 3.943)	Loss 3.0734e+00 (3.0734e+00)	Acc@1  19.53 ( 19.53)	Acc@5  45.31 ( 45.31)
 * Acc@1 11.245 Acc@5 34.137
acc1 = 11.2, best_acc1 = 11.2
Epoch: [1][  0/500]	Time  0.23 ( 0.23)	Data  0.09 ( 0.09)	Loss   1.00 (  1.00)	Cls Acc 72.7 (72.7)	Domain Acc 98.4 (98.4)
Epoch: [1][ 50/500]	Time  1.25 ( 1.57)	Data  1.11 ( 1.43)	Loss   0.98 (  1.06)	Cls Acc 75.8 (73.6)	Domain Acc 94.5 (97.2)
Epoch: [1][100/500]	Time  3.56 ( 1.58)	Data  3.41 ( 1.44)	Loss   1.70 (  1.45)	Cls Acc 70.3 (71.9)	Domain Acc 84.4 (89.0)
Epoch: [1][150/500]	Time  0.50 ( 1.56)	Data  0.37 ( 1.42)	Loss   4.78 (  1.65)	Cls Acc 69.5 (70.9)	Domain Acc 52.3 (84.2)
Epoch: [1][200/500]	Time  0.50 ( 1.56)	Data  0.37 ( 1.43)	Loss   3.66 (  1.79)	Cls Acc 67.2 (70.3)	Domain Acc 42.6 (81.3)
Traceback (most recent call last):
  File "/home/junzhin/Project/Summer_project/code/version2.0/common/utils/data.py", line 12, in __next__
    data = next(self.iter)
  File "/home/junzhin/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/junzhin/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1176, in _next_data
    raise StopIteration
StopIteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "../../../../dann_modified.py", line 407, in <module>
    main(args)
  File "../../../../dann_modified.py", line 152, in main
    lr_scheduler, epoch, args)
  File "../../../../dann_modified.py", line 208, in train
    x_t, _ = next(train_target_iter)
  File "/home/junzhin/Project/Summer_project/code/version2.0/common/utils/data.py", line 15, in __next__
    data = next(self.iter)
  File "/home/junzhin/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/junzhin/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1186, in _next_data
    idx, data = self._get_data()
  File "/home/junzhin/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1152, in _get_data
    success, data = self._try_get_data()
  File "/home/junzhin/anaconda3/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 990, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/junzhin/anaconda3/lib/python3.7/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/home/junzhin/anaconda3/lib/python3.7/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/junzhin/anaconda3/lib/python3.7/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/home/junzhin/anaconda3/lib/python3.7/multiprocessing/connection.py", line 921, in wait
    ready = selector.select(timeout)
  File "/home/junzhin/anaconda3/lib/python3.7/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
